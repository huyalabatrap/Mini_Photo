{% extends "_base.html" %}

{% block title %}Trang ch·ªß - Segmentation Studio{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">üéØ Ph√¢n ƒëo·∫°n ·∫£nh th√¥ng minh</h1>
    <p class="page-subtitle">T·∫£i l√™n ·∫£nh v√† ch·ªçn ph∆∞∆°ng ph√°p ph√¢n ƒëo·∫°n ph√π h·ª£p</p>
</div>

<div class="grid-container">
    <!-- Upload Form Section -->
    <section class="card upload-section">
        <div class="card-header">
            <h2 class="card-title">üì∏ Ph√¢n ƒëo·∫°n ·∫£nh (Mini Project)</h2>
        </div>
        
        <div class="card-body">
            <form id="uploadForm" action="{{ url_for('segment') }}" method="POST" enctype="multipart/form-data">
                <!-- Image Upload -->
                <div class="form-group">
                    <label for="imageInput" class="form-label">
                        <span class="label-icon">üñºÔ∏è</span>
                        Ch·ªçn ·∫£nh ƒë·ªÉ x·ª≠ l√Ω
                    </label>
                    <input 
                        type="file" 
                        name="image" 
                        id="imageInput" 
                        class="file-input"
                        accept="image/*" 
                        required
                    >
                    <div class="file-input-display">
                        <span class="file-input-text">Ch·ªçn file ·∫£nh...</span>
                        <span class="file-input-button">Duy·ªát</span>
                    </div>
                </div>

                <!-- Image Preview -->
                <div id="imagePreview" class="image-preview hidden">
                    <img id="previewImg" src="" alt="Preview">
                    <div class="preview-overlay">
                        <button type="button" class="preview-remove" onclick="removePreview()">
                            <span>√ó</span>
                        </button>
                    </div>
                </div>

                <!-- Method Selection -->
                <div class="form-group">
                    <label for="methodSelect" class="form-label">
                        <span class="label-icon">‚öôÔ∏è</span>
                        Ph∆∞∆°ng ph√°p ph√¢n ƒëo·∫°n
                    </label>
                    <select name="method" id="methodSelect" class="form-select" required>
                        <optgroup label="üéØ ·ª®ng d·ª•ng th·ª±c t·∫ø">
                            <option value="background">T√°ch n·ªÅn (GrabCut)</option>
                            <option value="count">ƒê·∫øm ƒë·ªëi t∆∞·ª£ng (Watershed)</option>
                            <option value="skin">Ph√¢n ƒëo·∫°n da (YCrCb)</option>
                            <option value="plate">Bi·ªÉn s·ªë xe (Contour)</option>
                            <option value="lesion">T·ªïn th∆∞∆°ng (CLAHE)</option>
                        </optgroup>
                        <optgroup label="üîß Ph∆∞∆°ng ph√°p c·ªï ƒëi·ªÉn">
                            <option value="otsu">Ng∆∞·ª°ng Otsu</option>
                            <option value="kmeans">Ph√¢n c·ª•m K-means</option>
                            <option value="canny">Ph√°t hi·ªán bi√™n Canny</option>
                            <option value="watershed">Watershed c·ªï ƒëi·ªÉn</option>
                        </optgroup>
                    </select>
                </div>

                <!-- Advanced Parameters -->
                <details id="advancedParams" class="advanced-params">
                    <summary class="params-summary">
                        <span class="summary-icon">üîß</span>
                        Tham s·ªë n√¢ng cao
                    </summary>
                    <div class="params-content">
                        <div class="params-grid">
                            <div class="param-group">
                                <label for="kmeansK" class="param-label">K-means K:</label>
                                <input 
                                    type="number" 
                                    name="kmeans_k" 
                                    id="kmeansK" 
                                    class="param-input"
                                    min="2" 
                                    max="6" 
                                    placeholder="3"
                                >
                                <small class="param-hint">S·ªë c·ª•m (2-6)</small>
                            </div>
                            
                            <div class="param-group">
                                <label for="cannyLow" class="param-label">Canny Low:</label>
                                <input 
                                    type="number" 
                                    name="canny_low" 
                                    id="cannyLow" 
                                    class="param-input"
                                    min="1" 
                                    max="255" 
                                    placeholder="50"
                                >
                                <small class="param-hint">Ng∆∞·ª°ng th·∫•p</small>
                            </div>
                            
                            <div class="param-group">
                                <label for="cannyHigh" class="param-label">Canny High:</label>
                                <input 
                                    type="number" 
                                    name="canny_high" 
                                    id="cannyHigh" 
                                    class="param-input"
                                    min="1" 
                                    max="255" 
                                    placeholder="150"
                                >
                                <small class="param-hint">Ng∆∞·ª°ng cao</small>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- Submit Button -->
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-icon">üöÄ</span>
                        <span class="btn-text">Ph√¢n ƒëo·∫°n</span>
                        <div class="btn-loading hidden">
                            <span class="spinner"></span>
                        </div>
                    </button>
                </div>
            </form>
        </div>
    </section>

    <!-- Tips Section -->
    <section class="card tips-section">
        <div class="card-header">
            <h2 class="card-title">üí° G·ª£i √Ω s·ª≠ d·ª•ng</h2>
        </div>
        
        <div class="card-body">
            <ul class="tips-list">
                <li class="tip-item">
                    <strong class="tip-method">üéØ T√°ch n·ªÅn:</strong>
                    <span class="tip-desc">Ph√π h·ª£p v·ªõi ·∫£nh ch√¢n dung, s·∫£n ph·∫©m c√≥ n·ªÅn ƒë∆°n gi·∫£n</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üî¢ ƒê·∫øm ƒë·ªëi t∆∞·ª£ng:</strong>
                    <span class="tip-desc">ƒê·∫øm xu, h·∫°t, t·∫ø b√†o, c√°c v·∫≠t th·ªÉ nh·ªè ri√™ng bi·ªát</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üë§ Ph√¢n ƒëo·∫°n da:</strong>
                    <span class="tip-desc">Ph√°t hi·ªán v√πng da ng∆∞·ªùi, th·ª±c ph·∫©m c√≥ m√†u t∆∞∆°ng t·ª±</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üöó Bi·ªÉn s·ªë xe:</strong>
                    <span class="tip-desc">T√¨m v√πng ch·ªØ nh·∫≠t c√≥ ƒë·ªô t∆∞∆°ng ph·∫£n cao</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üè• T·ªïn th∆∞∆°ng:</strong>
                    <span class="tip-desc">Ph√°t hi·ªán v·∫øt th∆∞∆°ng, ƒë·ªëm b·∫•t th∆∞·ªùng tr√™n da</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">‚ö° Otsu:</strong>
                    <span class="tip-desc">T√°ch foreground/background t·ª± ƒë·ªông, nhanh</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üé® K-means:</strong>
                    <span class="tip-desc">Ph√¢n nh√≥m theo m√†u s·∫Øc, ph√π h·ª£p ·∫£nh nhi·ªÅu m√†u</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üìê Canny:</strong>
                    <span class="tip-desc">Ph√°t hi·ªán ƒë∆∞·ªùng bi√™n, khung vi·ªÅn ƒë·ªëi t∆∞·ª£ng</span>
                </li>
                <li class="tip-item">
                    <strong class="tip-method">üíß Watershed:</strong>
                    <span class="tip-desc">T√°ch c√°c ƒë·ªëi t∆∞·ª£ng d√≠nh nhau, ph√¢n v√πng ch√≠nh x√°c</span>
                </li>
            </ul>

            <div class="tips-footer">
                <p class="tips-note">
                    <span class="note-icon">üìù</span>
                    <strong>L∆∞u √Ω:</strong> Ch·ªçn ƒë·ªãnh d·∫°ng ·∫£nh: PNG, JPG, JPEG, BMP, TIF, TIFF (t·ªëi ƒëa 10MB)
                </p>
            </div>
        </div>
    </section>
</div>

<script>
// Remove preview functionality
function removePreview() {
    const preview = document.getElementById('imagePreview');
    const input = document.getElementById('imageInput');
    const displayText = document.querySelector('.file-input-text');
    
    preview.classList.add('hidden');
    input.value = '';
    displayText.textContent = 'Ch·ªçn file ·∫£nh...';
}
</script>
{% endblock %}
